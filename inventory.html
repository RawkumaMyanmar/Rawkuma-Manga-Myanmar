<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Rawkuma | Items Box</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --bg: #0f172a;
            --card-bg: #1e293b;
            --accent: #8b5cf6;
            --glass: rgba(255, 255, 255, 0.05);
            --legendary: #fbbf24;
            --epic: #a855f7;
            --rare: #3b82f6;
            --common: #94a3b8;
        }

        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; margin: 0; padding: 20px; overflow-x: hidden; }

        .header { display: flex; align-items: center; gap: 15px; margin-bottom: 30px; }
        .back-btn { font-size: 20px; cursor: pointer; color: var(--accent); }
        .page-title { font-size: 20px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; }

        .inventory-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .item-card {
            background: var(--card-bg); border-radius: 15px; padding: 10px; text-align: center;
            border: 1px solid var(--glass); position: relative; transition: 0.3s;
            animation: fadeIn 0.5s ease backwards;
            min-height: 120px;
        }
        .item-card:active { transform: scale(0.9); }
        .item-card.legendary { border-color: var(--legendary); box-shadow: 0 0 15px rgba(251, 191, 36, 0.15); }
        .item-card.epic { border-color: var(--epic); }
        .item-card.rare { border-color: var(--rare); }

        /* ပုံပျောက်နေခြင်းကို ဖြေရှင်းရန် height သတ်မှတ်ပေးလိုက်သည် */
        .item-img { 
            width: 100%; 
            height: 80px; 
            object-fit: contain; 
            margin-bottom: 8px; 
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.3)); 
            display: block;
        }

        .item-qty { position: absolute; top: 5px; right: 8px; background: var(--accent); font-size: 10px; padding: 2px 6px; border-radius: 20px; z-index: 5; }
        .item-name { font-size: 11px; font-weight: 600; display: block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

        /* Modal for Details */
        #itemModal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); z-index: 2000;
        }
        .modal-content {
            width: 85%; max-width: 350px; margin: 100px auto; background: var(--card-bg);
            border-radius: 25px; padding: 30px; text-align: center; border: 1px solid var(--glass);
            animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal-img { width: 120px; height: 120px; object-fit: contain; margin-bottom: 20px; }
        .rarity-badge { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; margin-bottom: 15px; }
        .benefit-box { background: rgba(139, 92, 246, 0.1); padding: 15px; border-radius: 15px; font-size: 13px; color: #cbd5e1; margin-top: 15px; border: 1px solid rgba(139, 92, 246, 0.2); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }

        .empty-state { text-align: center; margin-top: 100px; color: #64748b; }
        .empty-state i { font-size: 50px; margin-bottom: 15px; opacity: 0.3; }
    </style>
</head>
<body>

    <div class="header">
        <i class="fas fa-arrow-left back-btn" onclick="history.back()"></i>
        <div class="page-title">Items Box</div>
    </div>

    <div class="inventory-grid" id="inventory-list">
        </div>

    <div id="empty-msg" class="empty-state" style="display: none;">
        <i class="fas fa-box-open"></i>
        <p>Items Box အထဲမှာ ဘာမှမရှိသေးပါဘူး</p>
    </div>

    <div id="itemModal" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <img id="modal-img" src="" class="modal-img">
            <div id="modal-rarity" class="rarity-badge">COMMON</div>
            <h2 id="modal-name" style="margin: 0 0 10px 0;">Item Name</h2>
            <p id="modal-desc" style="font-size: 14px; color: #94a3b8; margin-bottom: 20px;">Item Description goes here.</p>
            
            <div class="benefit-box">
                <div style="font-size: 11px; text-transform: uppercase; color: var(--accent); margin-bottom: 5px; font-weight: bold;">Hold Benefit</div>
                <div id="modal-benefit">No special benefits</div>
            </div>
            
            <button onclick="closeModal()" style="width: 100%; background: var(--glass); border: none; padding: 12px; border-radius: 12px; color: white; margin-top: 20px; font-weight: bold;">Close</button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDkC9yCwozUjgTfFZ140qG112cU8GDCh44",
            authDomain: "rawkuma-8f1ba.firebaseapp.com",
            projectId: "rawkuma-8f1ba",
            storageBucket: "rawkuma-8f1ba.firebasestorage.app",
            messagingSenderId: "8257070386",
            appId: "1:8257070386:web:74d861728b8378d86f232b"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        auth.onAuthStateChanged(user => {
            if (user) {
                loadInventory(user.uid);
            } else {
                window.location.href = "index.html";
            }
        });

        function loadInventory(uid) {
            const list = document.getElementById('inventory-list');
            const emptyMsg = document.getElementById('empty-msg');

            db.collection("users").doc(uid).collection("inventory").onSnapshot(snapshot => {
                list.innerHTML = "";
                if (snapshot.empty) {
                    emptyMsg.style.display = "block";
                    return;
                }
                emptyMsg.style.display = "none";
                
                snapshot.forEach(doc => {
                    const item = doc.data();
                    const card = document.createElement('div');
                    card.className = `item-card ${item.rarity ? item.rarity.toLowerCase() : 'common'}`;
                    card.onclick = () => showDetails(item);
                    card.innerHTML = `
                        <div class="item-qty">x${item.qty || 1}</div>
                        <img src="${item.image}" class="item-img" onerror="this.src='https://via.placeholder.com/80?text=No+Image'">
                        <span class="item-name">${item.name}</span>
                    `;
                    list.appendChild(card);
                });
            });
        }

        function showDetails(item) {
            document.getElementById('modal-img').src = item.image;
            document.getElementById('modal-name').innerText = item.name;
            document.getElementById('modal-desc').innerText = item.description || "ပစ္စည်းအကြောင်းအရာ မရှိသေးပါ။";
            document.getElementById('modal-benefit').innerText = item.benefit || "ဒီပစ္စည်းက အထူးစွမ်းရည် မရှိသေးပါ။";
            
            const rarityBadge = document.getElementById('modal-rarity');
            const rarity = item.rarity ? item.rarity.toLowerCase() : 'common';
            rarityBadge.innerText = rarity.toUpperCase();
            rarityBadge.style.backgroundColor = `var(--${rarity})`;
            
            document.getElementById('itemModal').style.display = "block";
        }

        function closeModal() {
            document.getElementById('itemModal').style.display = "none";
        }
    </script>
</body>
</html>
